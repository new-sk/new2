# 08. 분류분석

의사결정나무 분석 과정 : 성장, 가지치기, 타당성평가, 예측

<br>

분류기법

 - 로지스틱회귀분석

 - 의사결정나무

 - 베이지안 분류

 - 인공신경망

 - 지지도백터기계

 - k 최근접 이웃

 - 규칙기반의 분류와 사례기반추론

<br>

성장(growing)
 - 분류규칙(splitting rule)에 따라 나무를 성장, 적절한 정지규칙
 - 수식 : 불순도증가분 = 기존불순도 - 왼쪽확률*왼쪽불순도 - 오른쪽확률*오른쪽불순도
 - 재귀적 호출
 - 불순도 척도 : 카이제곱, 지니지수, 엔트로피지수

<br>

가지치기
 - 비용-복잡도 가지치기

<br>

타당성평가

<br>

예측

<br>

카이제곱 통계량
지니지수
엔트로피지수

<br>

CART : 범주형(지니)
C4.5/C5.0 : 다지분리가능, 엔트로피지수
CHAID : 가지치기 않함, 적당한 크기에서 성장 멈춤, 카이제곱통계량


party::ctree

rpart::rpart


<br>

앙상블

- 배깅 : 보팅,다수결,최대한성장
- 부스팅 : 훈련오차를 빨리 줄임
- 랜덤 포레스트 : 범주형변수의 종류는 32개를 넘을 수 없음

<br>

스태킹 : 다른 타입의 모델 조합

<br>

모델평가

 - 분류표

 - ROC커브 : 민감도 vs 1-특이도, AreaUnderROC(커브 밑부분 넓이)

   . ROCR 패키지, binary만 가능

 - 이익도표 (Lift Chart)

   . 전체 2000명 중 381명 구매, 등급 : 10개 -> 기본향상도(baseline lift) = 381/2000 = 19.05%

   . frequency of buy (구매자 수)

   . % Captured Response (반응검출률) = 해당 등급 실제 구매자 / 전체 구매자

   . % response (반응률) = 해당 등급 실제 구매자 / 200명 (등급별 인원)

   . Lift (향상도) = 반응률 / 기본향상도 -> 좋은 모델은 리프트가 빠르게 감소해야 함

 
<br>

로지스틱회귀분석

exp(Bi) 의미 : 변수 Xi가 한 단위 증가할 때마다 오즈가 몇 배 증가하는지 (오즈비 : Odds Ratio)

glm(종속변수 ~독립변수들, family=binomial)

<br>

다중로지스틱회귀분석

<br>

인공신경망 분석


비선형 문제 해결 못함 -> 역전파 알고리즘으로 해결


인간 뇌

 - 100억개 뉴런, 6조개 시냅스

 - 잘못된 답은 뉴런 연결 약화되고, 올바른 답은 강화됨

 - 뉴런은 가중치가 있는 링크들로 연결

 - 입력은 여러개, 출력은 오직 하나

<br>

R blogdown 참고자료

https://www.youtube.com/watch?v=ZcdDsRUT00U (2/3, R blogdown)